# Invers Pipeline Configuration
#
# This file controls the default processing behavior.
# All fields are optional - omit a value to use built-in defaults.
#
# In RELEASE builds, only the 7 essential options are used (inversion_mode,
# enable_auto_levels, preserve_headroom, exposure_compensation, enable_auto_color,
# skip_tone_curve, enable_auto_exposure). Release builds use MaskAware inversion by default.
#
# In DEBUG builds, all options are loaded including the testing section.
# Debug builds use Linear inversion by default.

defaults:
  # ==========================================================================
  # ESSENTIAL OPTIONS (used in both release and debug builds)
  # ==========================================================================

  # Method for inverting negative to positive
  # Options: MaskAware, Linear, Logarithmic, DivideBlend, BlackAndWhite
  inversion_mode: MaskAware

  # Enable automatic level adjustment to optimize tonal range
  enable_auto_levels: true

  # Preserve shadow/highlight headroom (don't stretch to full 0-1 range)
  # Set to false to preserve highlight detail for post-processing
  preserve_headroom: false

  # Manual exposure compensation multiplier (1.0 = no change, >1 = brighter)
  exposure_compensation: 1

  # Enable automatic color correction
  enable_auto_color: true

  # Skip applying film-specific tone curve during processing
  skip_tone_curve: false

  # Enable automatic exposure adjustment to normalize brightness
  # Automatically boosts underexposed negatives to proper brightness
  enable_auto_exposure: true

  # ==========================================================================
  # ADVANCED OPTIONS (debug builds only)
  # These are ignored in release builds, which use optimized hardcoded values.
  # ==========================================================================

  # Percentage of pixels to clip when computing auto levels (0.0-10.0)
  # Set to 0 to preserve all highlight detail
  auto_levels_clip_percent: 0.0

  # Strength of color correction adjustment (0.0-1.0+)
  auto_color_strength: 0.6

  # Gain limits for color correction
  auto_color_min_gain: 0.7
  auto_color_max_gain: 1.3

  # Base estimation: percentage of brightest pixels to sample (1.0-30.0)
  base_brightest_percent: 5.0

  # Base estimation sampling mode: Median, Mean, or Max
  base_sampling_mode: Median

  # Shadow lift mode: Fixed, Percentile, or None
  shadow_lift_mode: Percentile

  # Shadow lift target black point (0.0-0.1)
  shadow_lift_value: 0.02

  # Highlight compression factor (0.0-1.0, 1.0 = no compression)
  highlight_compression: 1.0

  # Auto exposure normalization (advanced tuning - debug builds only)
  # Note: enable_auto_exposure is now in essential options above
  auto_exposure_target_median: 0.63
  auto_exposure_strength: 1.0
  auto_exposure_min_gain: 0.3
  auto_exposure_max_gain: 3.0

  # Skip color matrix correction
  skip_color_matrix: false

# ==========================================================================
# TESTING CONFIGURATION (debug builds only)
# These settings are only loaded in debug builds for parameter optimization.
# ==========================================================================

testing:
  # Default parameters for single parameter tests
  parameter_test_defaults:
    enable_auto_levels: true
    clip_percent: 0.25
    enable_auto_color: true
    auto_color_strength: 0.6
    auto_color_min_gain: 0.7
    auto_color_max_gain: 1.3
    base_brightest_percent: 5.0
    base_sampling_mode: Median
    inversion_mode: Linear
    shadow_lift_mode: Percentile
    shadow_lift_value: 0.02
    highlight_compression: 1.0
    tone_curve_strength: 0.5
    skip_tone_curve: false
    exposure_compensation: 1.0
    enable_auto_exposure: true
    auto_exposure_target_median: 0.25
    auto_exposure_strength: 1.0
    auto_exposure_min_gain: 0.6
    auto_exposure_max_gain: 1.4

  # Parameter grid for batch testing (default grid)
  default_grid:
    auto_levels: [true]
    clip_percent: [0.25, 0.5, 1.0]
    auto_color: [true, false]
    auto_color_strength: [0.6, 0.8]
    auto_color_min_gain: [0.7, 0.8]
    auto_color_max_gain: [1.2, 1.3]
    base_brightest_percent: [5.0, 10.0, 15.0]
    base_sampling_mode: [Median]
    inversion_mode: [Linear]
    shadow_lift_mode: [Percentile]
    shadow_lift_value: [0.02]
    tone_curve_strength: [0.4, 0.5, 0.6, 0.7]
    exposure_compensation: [1.0]
